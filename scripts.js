document.addEventListener("DOMContentLoaded",()=>{if(null!==document.querySelector("#bannersubscribeform")){let i=document.querySelector("#bannersubscribeform"),r=document.querySelector("#bannersubscribeform button");function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}i.onsubmit=async t=>{if(t.preventDefault(),!i.elements.snarefortheunwary.value){i.insertAdjacentHTML("beforeend",'<div class="alert"></div>');let e=document.querySelector("#bannersubscribeform .alert");var t=new FormData(i),n=t.get("email").trim();if(s(n)){e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free",r.disabled=!0,r.textContent="Sending ...";try{(await fetch("https://sc8pprwk2k.execute-api.eu-west-2.amazonaws.com/dev/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(t))})).ok?(e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Thanks for subscribing to The Exeter Digest: the next edition will be with you soon.</p></div>',r.disabled=!0,r.textContent="Sent"):(e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>There was a problem submitting your details: please try again.</p></div>',r.disabled=!0,r.textContent="Not sent")}catch(e){console.error("Error submitting form:",e)}e.addEventListener("click",()=>{e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free",i.reset()})}else e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Please enter a valid email address</p></div>',r.disabled=!0,r.textContent="Not sent",e.addEventListener("click",()=>{e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free"})}}}if(null!==document.querySelector("#insertsubscribeform")){let i=document.querySelector("#insertsubscribeform"),r=document.querySelector("#insertsubscribeform button");function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}i.onsubmit=async t=>{if(t.preventDefault(),!i.elements.snarefortheunwary.value){i.insertAdjacentHTML("beforeend",'<div class="alert"></div>');let e=document.querySelector("#insertsubscribeform .alert");var t=new FormData(i),n=t.get("email").trim();if(s(n)){e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free",r.disabled=!0,r.textContent="Sending ...";try{(await fetch("https://sc8pprwk2k.execute-api.eu-west-2.amazonaws.com/dev/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(t))})).ok?(e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Thanks for subscribing to The Exeter Digest: the next edition will be with you soon.</p></div>',r.disabled=!0,r.textContent="Sent"):(e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>There was a problem submitting your details: please try again.</p></div>',r.disabled=!0,r.textContent="Not sent")}catch(e){console.error("Error submitting form:",e)}e.addEventListener("click",()=>{e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free",i.reset()})}else e.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Please enter a valid email address</p></div>',r.disabled=!0,r.textContent="Not sent",e.addEventListener("click",()=>{e.innerHTML="",r.disabled=!1,r.textContent="Subscribe free"})}}}});
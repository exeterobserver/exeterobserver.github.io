document.addEventListener("DOMContentLoaded",(()=>{if(null!==document.querySelector("#bannersubscribeform")){const t=document.querySelector("#bannersubscribeform"),n=document.querySelector("#bannersubscribeform button");function e(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}t.onsubmit=async r=>{if(r.preventDefault(),t.elements.snarefortheunwary.value)return;t.insertAdjacentHTML("beforeend",'<div class="alert"></div>');const i=document.querySelector("#bannersubscribeform .alert"),s=new FormData(t),o=s.get("email").trim();if(!e(o))return i.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Please enter a valid email address</p></div>',n.disabled=!0,n.textContent="Not sent",void i.addEventListener("click",(()=>{i.innerHTML="",n.disabled=!1,n.textContent="Subscribe free"}));i.innerHTML="",n.disabled=!1,n.textContent="Subscribe free",n.disabled=!0,n.textContent="Sending ...";try{(await fetch("https://sc8pprwk2k.execute-api.eu-west-2.amazonaws.com/dev/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(s))})).ok?(i.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Thanks for subscribing to The Exeter Digest: the next edition will be with you soon.</p></div>',n.disabled=!0,n.textContent="Sent"):(i.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>There was a problem submitting your details: please try again.</p></div>',n.disabled=!0,n.textContent="Not sent")}catch(e){console.error("Error submitting form:",e)}i.addEventListener("click",(()=>{i.innerHTML="",n.disabled=!1,n.textContent="Subscribe free",t.reset()}))}}if(null!==document.querySelector("#insertsubscribeform")){const r=document.querySelector("#insertsubscribeform"),i=document.querySelector("#insertsubscribeform button");function e(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}r.onsubmit=async t=>{if(t.preventDefault(),r.elements.snarefortheunwary.value)return;r.insertAdjacentHTML("beforeend",'<div class="alert"></div>');const n=document.querySelector("#insertsubscribeform .alert"),s=new FormData(r),o=s.get("email").trim();if(!e(o))return n.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Please enter a valid email address</p></div>',i.disabled=!0,i.textContent="Not sent",void n.addEventListener("click",(()=>{n.innerHTML="",i.disabled=!1,i.textContent="Subscribe free"}));n.innerHTML="",i.disabled=!1,i.textContent="Subscribe free",i.disabled=!0,i.textContent="Sending ...";try{(await fetch("https://sc8pprwk2k.execute-api.eu-west-2.amazonaws.com/dev/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(s))})).ok?(n.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>Thanks for subscribing to The Exeter Digest: the next edition will be with you soon.</p></div>',i.disabled=!0,i.textContent="Sent"):(n.innerHTML='<div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><path stroke-width="1" d="M16,16 L4,4"/><path stroke-width="1" d="M16,4 L4,16"/></svg><p>There was a problem submitting your details: please try again.</p></div>',i.disabled=!0,i.textContent="Not sent")}catch(e){console.error("Error submitting form:",e)}n.addEventListener("click",(()=>{n.innerHTML="",i.disabled=!1,i.textContent="Subscribe free",r.reset()}))}}}));